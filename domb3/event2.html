<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <input id="email" name="email" type="text" placeholder="Nhap email" />
    <!-- <input type="checkbox" />
    <input type="radio" />
    <input type="date" /> -->
    <input id="pw" name="password" type="text" placeholder="Nhap pw" />
    <input id="rePw" name="rePassword" type="text" placeholder="Nhap lai pw" />

    <button id="save">save</button>
  </body>
</html>
<script>
  const emailELe = document.getElementById("email");
  const pwELe = document.getElementById("pw");
  const rePwELe = document.getElementById("rePw");
  const saveBtn = document.getElementById("save");
  saveBtn.disabled = true;

  console.log("emailELe", emailELe);

  const usersInit = [];

  emailELe.addEventListener("input", (event) => {
    const target = event.target;
    const name = target.name;
    const value = target.value;
    console.log("name", name, value);
    if (emailELe.value && pwELe.value && rePwELe.value) {
      saveBtn.disabled = false;
    } else {
      saveBtn.disabled = true;
    }
  });

  pwELe.addEventListener("input", (event) => {
    const target = event.target;
    const name = target.name;
    const value = target.value;
    console.log("name", name, value);
    if (emailELe.value && pwELe.value && rePwELe.value) {
      saveBtn.disabled = false;
    } else {
      saveBtn.disabled = true;
    }
  });

  rePwELe.addEventListener("input", (event) => {
    const target = event.target;
    const name = target.name;
    const value = target.value;
    console.log("name", name, value);
    if (emailELe.value && pwELe.value && rePwELe.value) {
      saveBtn.disabled = false;
    } else {
      saveBtn.disabled = true;
    }
  });

  saveBtn.addEventListener("click", (event) => {
    const target = event.target;
    console.log("savinggg...");

    console.log("preInit", usersInit);
    if (pwELe.value !== rePwELe.value) {
      alert("vui lòng kiểm tra mật khẩu nhập lại");
      return;
    }
    // todo
    //

    const email = emailELe.value;
    const password = pwELe.value;
    const userExisted = usersInit.find((value, index) => {
      return value.email === email;
    });
    if (userExisted) {
      alert("đã tồn tại email");
      return;
    }
    // add 1 user to initUSer  // id , email , password, createdAt

    const newUser = {
      id: new Date().getDate(),
      email: email,
      ["password"]: password,
      createdAt: new Date().toISOString(),
    };

    usersInit.push(newUser);
    emailELe.value = "";
    pwELe.value = "";
    rePwELe.value = "";

    console.log("currentInit", usersInit);
  });
</script>
